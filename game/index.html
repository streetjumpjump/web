<html ng-app="frogger" ng-controller="Game as game">
<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
    <script src='http://cdn.html5quintus.com/v0.2.0/quintus-all.js'></script>
    <script src="../ui/app.js"></script>
    <script src="../ui/infoService.js"></script>

    <title>{{ game.info.title }}</title>
</head>
<body>
    <h1>Complete</h1>

    <canvas id="quintus" width="250" height="200" style="background-color: #EEE;"></canvas>

    <script>
        (function() {
            'use strict';

            var app = angular.module('frogger');

            app.controller('Game', ['infoService', function(infoService) {
                var vm = this;

                vm.info = infoService;
                // begin Quintus code -_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_

                var Q = Quintus({ development: true })
                    .include("Scenes, Sprites, Input, 2D, Touch, UI")
                    .setup("quintus")
                    .controls()
                    .touch()

                Q.Sprite.extend("Player", {
                    init: function(p) {
                        this._super({
                            asset: infoService.player,
                            w: 25,
                            h: 25,
                            x: 100 + 12.5,
                            y: 175 + 12.5
                        });
                        //this.add("2d");

                        //this.on("hit.sprite", function(collision) {
                        //    if (collision.obj.isA("VictoryZone")) {
                        //        console.log('win');
                        //        //Q.stageScene("endGame", 1, { label: "You Won!" });
                        //        //this.destroy();
                        //    }
                        //});
                    }
                });

                Q.Sprite.extend("VictoryZone", {
                    init: function(p) {
                        this._super(
                            {
                                asset: infoService.victoryZone,
                                w: 250,
                                h: 25,
                                x: 125,
                                y: 12.5
                            });
                    }
                });

                Q.Sprite.extend("Enemy", {
                    init: function(p) {
                        this._super({
                            asset: infoService.enemy,
                            w: 25,
                            h: 25
                        });
                        //this.add('2d, aiBounce');

                        this.on("bump.left,bump.right,bump.bottom, bump.top", function(collision) {
                            if (collision.obj.isA("Player")) {
                                Q.stageScene("endGame", 1, { label: "You Died" });
                                collision.obj.destroy();
                            }
                        });

                        //this.on("bump.top",function(collision) {
                        //    if(collision.obj.isA("Player")) {
                        //        this.destroy();
                        //        collision.obj.p.vy = -300;
                        //    }
                        //});
                    }
                });

                Q.Sprite.extend("Road", {
                    init: function(p) {
                        this._super(
                            {
                                asset: infoService.road,
                                w: 250,
                                h: 25,
                                x: 125
                            });
                    }
                });

                //Q.load([infoService.victoryZone, infoService.player], function() {
                //    //Q.load([infoService.player, infoService.enemy, infoService.victoryZone], function() {
                //    var player = new Q.Player();
                //    var victoryZone = new Q.VictoryZone();
                //    //var enemy = new Q.Enemy();

                //    Q.gameLoop(function(dt) {
                //        Q.clear();
                //        player.update(dt);
                //        //enemy.update(dt);
                //        victoryZone.update(dt);
                //        player.render(Q.ctx);
                //        //enemy.render(Q.ctx);
                //        victoryZone.render(Q.ctx);
                //    });
                //});

                Q.scene("level1", function(stage) {
                    var player = stage.insert(new Q.Player());
                    stage.insert(new Q.Enemy({ x: 100, y: 100 }));
                    stage.insert(new Q.Enemy({ x: 50, y: 100 }));
                    stage.insert(new Q.Road({ y: 20 + 12.5 }));
                    stage.insert(new Q.Road({ y: 40 + 12.5 }));
                    stage.insert(new Q.Road({ y: 60 + 12.5 }));
                    stage.insert(new Q.Road({ y: 80 + 12.5 }));
                    stage.insert(new Q.Road({ y: 100 + 12.5 }));
                    stage.insert(new Q.VictoryZone());
                });

                Q.stageScene("level1");

                //Q.scene("level1", function(stage) {
                //    var player = stage.insert(new Q.Player());

                //    stage.insert(new Q.Enemy({ x: 700, y: 0 }));
                //    stage.insert(new Q.Enemy({ x: 800, y: 0 }));

                //    stage.insert(new Q.Tower({ x: 180, y: 50 }));
                //});

                //Q.scene('endGame', function(stage) {
                //    var box = stage.insert(new Q.UI.Container({
                //        x: Q.width / 2, y: Q.height / 2, fill: "rgba(0,0,0,0.5)"
                //    }));

                //    var button = box.insert(new Q.UI.Button({
                //        x: 0, y: 0, fill: "#CCCCCC",
                //        label: "Play Again"
                //    }))
                //    var label = box.insert(new Q.UI.Text({
                //        x: 10, y: -10 - button.p.h,
                //        label: stage.options.label
                //    }));
                //    button.on("click", function() {
                //        Q.clearStages();
                //        Q.stageScene('level1');
                //    });
                //    box.fit(20);
                //});
            }]);
        })();


    </script>
</body>
</html>